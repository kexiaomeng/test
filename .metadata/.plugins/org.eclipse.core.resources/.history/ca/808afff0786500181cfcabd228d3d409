package com.nari.sun.netty;

import java.nio.ByteBuffer;

import io.netty.channel.ChannelHandlerAdapter;
import io.netty.channel.ChannelHandlerContext;

public class ClientHandler extends ChannelHandlerAdapter{
	
	@Override
	 public void channelActive(ChannelHandlerContext ctx) throws Exception{
		String bufferString = "000100010001000201";
    	for(int i = 0;i<10;i++){
    		byte[] req = transHexStrToBuff(bufferString);
    		ByteBuffer writeBuffer = ByteBuffer.allocate(req.length);
    		writeBuffer.put(req);
    		writeBuffer.flip();
    		sc.write(writeBuffer);
    		if (!writeBuffer.hasRemaining())
    		    System.out.println("Send order 2 server succeed.");
    	}
	}
	@Override
	public void channelRead(ChannelHandlerContext ctx,Object obj){
		
	}
	
	   public static byte[] transHexStrToBuff(String hexString){
			int length = hexString.length();
			byte[] buffer = new byte[length / 2];

			for (int i = 0; i < length; i += 2) {
				buffer[i / 2] = (byte) ((toByte(hexString.charAt(i)) << 4) | toByte(hexString
						.charAt(i + 1)));
			}

			return buffer;
		}
	    
		private static int toByte(char c) {
			if (c >= '0' && c <= '9')
				return (c - '0');
			if (c >= 'A' && c <= 'F')
				return (c - 'A' + 10);
			if (c >= 'a' && c <= 'f')
				return (c - 'a' + 10);

			throw new RuntimeException("Invalid hex char '" + c + "'");
		}
		
}
